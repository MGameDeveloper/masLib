#pragma once

///////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////////
#include <stdint.h>


///////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////////
struct mas_component_query_desc
{
    uint64_t name_hash;
    uint32_t size;
    uint32_t unique_id;
    uint32_t offset;
};

struct mas_component_query
{
    mas_component_query_desc *comps;
    uint64_t                  comps_hash;
    uint32_t                  count;
    uint32_t                  total_comps_size;
};


///////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////////
bool mas_ecs_components_init();
void mas_ecs_components_deinit();
void mas_ecs_components_register(const char* name, size_t size);
mas_component_query* mas_ecs_components_query(const char** comp_name_list, uint32_t count);

// FOR DEBUG
void mas_ecs_comonents_print();


///////////////////////////////////////////////////////////////////////////////////////
//
///////////////////////////////////////////////////////////////////////////////////////
#define MAS_COMPONENT_REGISTER(comp)\
    mas_ecs_components_register(#comp, sizeof(comp))

#define MAS_ARRAY_SIZE(a) (sizeof(a)/sizeof(a[0]))
#define MAS_COMP(c)        #c

#define MAS_COMPONENT_QUERY_LIST(name, ...)           \
    const char* name##_query_list[] = { __VA_ARGS__ };\
    mas_component_query* name = mas_ecs_components_query(name##_query_list, MAS_ARRAY_SIZE(name##_query_list))